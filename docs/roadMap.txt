HeyBridge - Slack Clone Development Roadmap
===========================================

## PHASE 1: Authentication & User Management âœ… (COMPLETED)
---------------------------------------------------------
1.1. Firebase Setup
   - âœ… Firebase Authentication (Email/Password)
   - âœ… Firestore Database
   - âœ… Firebase configuration for iOS, Android, Web

1.2. Auth Screens
   - âœ… Login Screen (Responsive - Mobile & Desktop)
   - âœ… Sign Up Screen (Responsive)
   - âœ… Password visibility toggle
   - âœ… Form validation
   - âœ… Error handling

1.3. User Model & Firestore Integration
   - âœ… UserModel (uid, email, displayName, photoURL, createdAt, lastSeen, workspaceIds)
   - âœ… FirestoreService (CRUD operations for users)
   - âœ… Auto-create user document in Firestore on registration
   - âœ… Never store passwords in Firestore

1.4. Initial Workspace Screen
   - âœ… Workspace selection screen (Create/Join workspace)
   - âœ… Logout functionality


## PHASE 2: Workspace Management âœ… (COMPLETED)
------------------------------------------------
2.1. Workspace Model & Database Structure
   - âœ… Workspace Model (id, name, description, ownerId, memberIds, channelIds, createdAt)
   - âœ… Firestore collection: workspaces/{workspaceId}
   - âœ… WorkspaceService (create, read, update, delete, join, leave)

2.2. Workspace Creation
   - âœ… Create Workspace Modal Dialog enhancement
   - âœ… Workspace name validation
   - âœ… Auto-add creator as owner and first member, with password protection option
   - âœ… Generate unique workspace ID
   - âœ… Create default #general channel

2.3. Workspace Join
   - âœ… Join Workspace Dialog enhancement
   - âœ… Invite code generation and validation
   - âœ… Add user to workspace members
   - âœ… Update user's workspaceIds array
   - âœ… Password validation for protected workspaces

2.4. Workspace List Screen
   - âœ… Display user's workspaces
   - âœ… Show member count
   - âœ… Lock icon for password-protected workspaces
   - âœ… Workspace selection (navigate to channels - pending)
   - [ ] Workspace settings icon (deferred to later)
   - [ ] User profile section at bottom (deferred to later)

2.5. Workspace Settings (Deferred to Phase 8)
   - [ ] Edit workspace name
   - [ ] Manage members (view, invite, remove)
   - [ ] Generate/regenerate invite codes
   - [ ] Delete workspace (owner only)
   - [ ] Leave workspace


## PHASE 3: Channel System âœ… (COMPLETED)
--------------------------
3.1. Channel Model & Database Structure
   - âœ… Channel Model (id, workspaceId, name, description, isPrivate, memberIds, createdBy, createdAt)
   - âœ… Firestore subcollection: workspaces/{workspaceId}/channels/{channelId}
   - âœ… ChannelService (create, read, update, delete, join, leave)

3.2. Channel List Screen (Left Sidebar - Main View)
   - âœ… Display workspace info at top
   - âœ… Search/Jump to functionality
   - âœ… Threads section (placeholder)
   - âœ… Drafts & Sent section (placeholder)
   - âœ… Mentions & Reactions section (placeholder)
   - [ ] Starred channels section (deferred to Phase 6)
   - âœ… Public channels list
   - âœ… Private channels list
   - âœ… Direct Messages list (placeholder)
   - âœ… Add channel button
   - âœ… Bottom navigation (Home, DMs, Mentions, You)

3.3. Channel Creation
   - âœ… Create channel dialog
   - âœ… Channel name validation (lowercase, no spaces, #prefix)
   - âœ… Public/Private toggle
   - âœ… Channel description
   - âœ… Auto-add creator to channel members
   - [ ] Add initial members (for private channels) (deferred to Phase 6)

3.4. Channel Settings
   - âœ… Edit channel name and description
   - [ ] Channel members list (placeholder - deferred to Phase 6)
   - [ ] Add/remove members (deferred to Phase 6)
   - âœ… Archive/delete channel
   - âœ… Leave channel
   - [ ] Notification preferences (placeholder - deferred to Phase 7)


## PHASE 4: Real-Time Messaging System âœ… (COMPLETED)
---------------------------------------
4.1. Message Model & Database Structure
   - âœ… Message Model (id, channelId, senderId, text, attachments, replyToId, reactions, createdAt, updatedAt, isEdited, isDeleted)
   - âœ… Firestore subcollection: workspaces/{workspaceId}/channels/{channelId}/messages/{messageId}
   - âœ… MessageService (send, read, update, delete, react)

4.2. Chat Screen (Main Chat Area - Center View)
   - âœ… Channel header (name, member count, description, info icon)
   - âœ… Back button (mobile)
   - âœ… Message list with real-time updates
   - âœ… Message grouping by date
   - âœ… Sender info (avatar, name, timestamp)
   - âœ… Message reactions display
   - [ ] Thread indicator (deferred to Phase 6)
   - [ ] Scroll to bottom button (deferred to Phase 8)
   - [ ] Unread message indicator (deferred to Phase 7)
   - âœ… Loading states

4.3. Message Input
   - âœ… Rich text input field
   - âœ… Placeholder text (e.g., "Message #design-team")
   - [ ] Formatting toolbar (bold, italic, code, etc.) (deferred to Phase 6)
   - [ ] @ mention autocomplete (deferred to Phase 6)
   - [ ] # channel reference autocomplete (deferred to Phase 6)
   - âœ… Emoji picker
   - [ ] File attachment button (placeholder - deferred to Phase 6)
   - âœ… Send button
   - [ ] Voice message option (deferred to Phase 9)
   - âœ… Edit mode (shows "Editing message" indicator)
   - âœ… Reply mode (shows reply preview)

4.4. Message Features
   - âœ… Send text messages
   - âœ… Edit messages (show "edited" indicator)
   - âœ… Delete messages (soft delete with "This message was deleted" placeholder)
   - âœ… Reply to messages (with quoted message preview)
   - âœ… React to messages (emoji reactions with add/remove functionality)
   - âœ… Long-press menu (Reply, Add Reaction, Copy, Edit, Delete)
   - âœ… Reaction toggle (click to add/remove reaction)
   - âœ… Visual feedback for own reactions (highlighted in blue)
   - âœ… Swipe-to-reply gesture (WhatsApp-style, 40% threshold with Reply button)
   - âœ… Copy message text (clipboard copy with feedback)
   - [ ] Share message link (deferred to Phase 6)
   - âœ… Pin important messages (pin/unpin with visual indicator)
   - [ ] Reply in thread (deferred to Phase 6)
   - âœ… Star/save messages (save/unsave with visual indicator)

4.5. Real-Time Updates
   - âœ… Stream messages from Firestore
   - [ ] Typing indicators (deferred to Phase 7)
   - âœ… Online/offline status (real-time presence with 1-min heartbeat)
   - âœ… Message delivery status (WhatsApp-style tick marks: âœ“ sent, âœ“âœ“ delivered, blue âœ“âœ“ read)
   - [ ] Read receipts (optional) (deferred to Phase 7)
   - [ ] Push notifications for new messages (deferred to Phase 7)


## PHASE 5: Direct Messages (DMs) âœ… (COMPLETED)
----------------------------------
5.1. DM Model & Database Structure
   - âœ… DM Model (id, workspaceId, participantIds, lastMessage, lastMessageAt, unreadCounts, isArchived)
   - âœ… Firestore collection: workspaces/{workspaceId}/directMessages/{dmId}
   - âœ… Reuse Message model for DM messages
   - âœ… DMService (getOrCreate, read, update, archive, mark as read)

5.2. DM List Screen
   - âœ… Recent DMs list (sorted by last message time)
   - âœ… User avatars with placeholder for online status
   - âœ… Last message preview
   - âœ… Unread count badge
   - âœ… Empty state with illustration
   - âœ… Start new DM button
   - âœ… Archive DM option (implemented in service)
   - [ ] Search DMs (deferred to Phase 6)

5.3. DM Chat Screen
   - âœ… Dedicated DM Chat Screen (similar to Channel Chat)
   - âœ… Show participant info in header with avatar
   - âœ… 1-on-1 conversation layout
   - âœ… All message features (send, edit, delete, reply, reactions)
   - âœ… Swipe-to-reply gesture
   - âœ… Emoji picker
   - âœ… Date headers
   - âœ… Auto-mark as read when opening
   - [ ] Call buttons (voice/video) - deferred to Phase 9

5.4. Start New DM
   - âœ… User search/selection screen
   - âœ… Filter workspace members (current workspace only)
   - âœ… Search by name or email
   - âœ… Create or navigate to existing DM
   - âœ… Workspace-specific DMs (DMs tied to each workspace)
   - [ ] Support group DMs (3+ people) - deferred to Phase 9


## PHASE 6: Threading & Advanced Features
------------------------------------------
6.1. Thread System
   - [ ] Thread Model (stores thread metadata)
   - [ ] Reply-to functionality
   - [ ] Thread view (slide-in panel on desktop, new screen on mobile)
   - [ ] Thread message counter
   - [ ] Thread participants
   - [ ] "Also send to #channel" option
   - [ ] Thread notifications

6.2. Search Functionality
   - [ ] Global search (messages, files, people)
   - [ ] Search within channel
   - [ ] Search filters (from user, date range, has files)
   - [ ] Search results view
   - [ ] Recent searches

6.3. File Sharing
   - [ ] File upload (images, documents, videos)
   - [ ] Firebase Storage integration
   - [ ] Image preview in chat
   - [ ] Document viewer
   - [ ] File download
   - [ ] File size limits
   - [ ] File type restrictions

6.4. User Profile & Settings
   - [ ] User profile screen
   - [ ] Edit display name
   - [ ] Upload profile photo
   - [ ] Status/mood message
   - [ ] Notification preferences
   - [ ] Theme settings (light/dark mode)
   - [ ] Account settings
   - [ ] Logout


## PHASE 7: Notifications & Presence (PARTIALLY COMPLETED)
-----------------------------------------------------------
7.1. Push Notifications
   - [ ] Firebase Cloud Messaging setup
   - [ ] Notification permissions
   - [ ] New message notifications
   - [ ] Mention notifications
   - [ ] DM notifications
   - [ ] Notification settings per channel
   - [ ] Mute notifications
   - [ ] Do Not Disturb mode

7.2. Presence System âœ… (COMPLETED)
   - âœ… Online/offline status (isOnline field in UserModel)
   - âœ… Last seen timestamp (relative time: "son gÃ¶rÃ¼lme: X dk Ã¶nce")
   - âœ… "Active now" indicator (green dot + "Ã‡evrimiÃ§i" text)
   - âœ… PresenceService with 1-minute heartbeat
   - âœ… App lifecycle integration (paused â†’ offline, resumed â†’ online)
   - âœ… Real-time updates in DM chat header
   - [ ] Away/Do Not Disturb status
   - [ ] Custom status messages
   - [ ] Presence in user lists (DM list, member list)


## PHASE 8: Polish & Optimization
----------------------------------
8.1. UI/UX Improvements
   - [ ] Loading states for all async operations
   - [ ] Empty states with illustrations
   - [ ] Error states with retry options
   - [ ] Skeleton loaders
   - [ ] Smooth animations and transitions
   - [ ] Haptic feedback (mobile)
   - [ ] Keyboard shortcuts (desktop)

8.2. Performance Optimization
   - [ ] Message pagination (load older messages)
   - [ ] Image caching
   - [ ] Lazy loading for user lists
   - [ ] Optimize Firestore queries
   - [ ] Debounce search inputs
   - [ ] Virtual scrolling for long message lists

8.3. Offline Support
   - [ ] Cache recent messages locally
   - [ ] Queue messages when offline
   - [ ] Sync when back online
   - [ ] Offline indicator

8.4. Security & Validation
   - [ ] Firestore security rules
   - [ ] Input sanitization
   - [ ] Rate limiting
   - [ ] User permissions (admin, member, guest)
   - [ ] Channel permissions


## PHASE 9: Advanced Features (Future)
---------------------------------------
9.1. Voice & Video Calls
   - [ ] WebRTC integration
   - [ ] 1-on-1 voice calls
   - [ ] 1-on-1 video calls
   - [ ] Group calls
   - [ ] Screen sharing

9.2. Integrations & Bots
   - [ ] Webhook support
   - [ ] Slash commands
   - [ ] Bot users
   - [ ] Third-party integrations

9.3. Enterprise Features
   - [ ] Workspace analytics
   - [ ] Message export
   - [ ] Compliance tools
   - [ ] SSO integration
   - [ ] Advanced permissions


## DATABASE STRUCTURE OVERVIEW
==============================

Firestore Collections:
----------------------

users/
  {userId}/
    - uid: string
    - email: string
    - displayName: string
    - photoURL: string?
    - createdAt: timestamp
    - lastSeen: timestamp
    - isOnline: boolean (real-time presence status)
    - workspaceIds: array<string>

workspaces/
  {workspaceId}/
    - id: string
    - name: string
    - description: string
    - ownerId: string
    - memberIds: array<string>
    - channelIds: array<string>
    - inviteCode: string
    - createdAt: timestamp
    - updatedAt: timestamp

    channels/
      {channelId}/
        - id: string
        - workspaceId: string
        - name: string
        - description: string
        - isPrivate: boolean
        - memberIds: array<string>
        - createdBy: string
        - createdAt: timestamp

        messages/
          {messageId}/
            - id: string
            - channelId: string
            - senderId: string
            - text: string
            - attachments: array
            - replyToId: string?
            - reactions: map (emoji -> array<userId>)
            - createdAt: timestamp
            - updatedAt: timestamp?
            - isEdited: boolean
            - isDeleted: boolean

    directMessages/
      {dmId}/
        - id: string
        - participantIds: array<string>
        - lastMessage: string
        - lastMessageAt: timestamp
        - unreadCounts: map (userId -> count)

        messages/
          {messageId}/
            - (same structure as channel messages)


## TECH STACK
=============
- Frontend: Flutter (iOS, Android, Web)
- Backend: Firebase
  - Authentication: Firebase Auth
  - Database: Cloud Firestore
  - Storage: Firebase Storage
  - Functions: Cloud Functions (future)
  - Messaging: Firebase Cloud Messaging
- State Management: Provider
- Real-time: Firestore Streams


## DESIGN PRINCIPLES
====================
1. Responsive Design (Mobile-first, Desktop-optimized)
2. Dark Theme Primary (Light theme optional)
3. Slack-inspired UI/UX
4. Smooth Animations
5. Accessibility (screen readers, keyboard navigation)
6. Offline-first where possible
7. Real-time by default


## CURRENT PROGRESS
===================
âœ… Phase 1: Complete (Auth, User Management, Initial Workspace Screen)
âœ… Phase 2: Complete (Workspace Management)
âœ… Phase 3: Complete (Channel System)
âœ… Phase 4: Complete (Real-Time Messaging System - All core features implemented!)
   - âœ… Message send/receive with real-time updates
   - âœ… Chat bubbles with sender info and timestamps
   - âœ… Reply to messages with preview
   - âœ… Edit messages with visual indicator (null safety fix applied)
   - âœ… Delete messages (soft delete)
   - âœ… Emoji reactions (add/remove/toggle)
   - âœ… Emoji picker for messages and reactions
   - âœ… Date grouping headers
   - âœ… Long-press context menu
   - âœ… Unknown User display name fix
   - âœ… Swipe-to-reply gesture (WhatsApp-style with visible button)
   - âœ… Copy message text to clipboard
   - âœ… Pin/unpin messages with visual indicator
   - âœ… Star/save messages with visual indicator
   - âœ… WhatsApp-style message status ticks (âœ“ sent, âœ“âœ“ delivered, blue âœ“âœ“ read)
âœ… Phase 5: Complete (Direct Messages System - Workspace-specific DMs!)
   - âœ… DM model and service with workspace isolation
   - âœ… DM List screen with unread counts
   - âœ… DM Chat screen with all messaging features
   - âœ… New DM screen with workspace member search
   - âœ… Navigation integration
   - âœ… Firestore security rules for DMs
ğŸ”„ Phase 7: Partially Complete (Presence System)
   - âœ… Online/offline status with real-time updates
   - âœ… Last seen timestamp (relative time format)
   - âœ… Green dot indicator for online users
   - âœ… PresenceService with 1-minute heartbeat
   - âœ… App lifecycle integration
â³ Phase 6, 8-9: Planned


## NOTES
========
- Always prioritize security (never store passwords, validate inputs)
- Keep Firestore costs in mind (optimize queries, use pagination)
- Test on multiple devices and screen sizes
- Regular code reviews and refactoring
- Document all major features
- Write unit and widget tests for critical features
